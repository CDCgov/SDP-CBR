<?xml version="1.0" encoding="UTF-8"?>
<beans xmlns="http://www.springframework.org/schema/beans"
  xmlns:camel="http://camel.apache.org/schema/spring"
  xmlns:context="http://www.springframework.org/schema/context"
  xmlns:jee="http://www.springframework.org/schema/jee"
  xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/jee http://www.springframework.org/schema/jee/spring-jee.xsd http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd                                http://camel.apache.org/schema/spring http://camel.apache.org/schema/spring/camel-spring.xsd                        ">
  <!-- START SNIPPET: e1 -->
  <bean id="set_email_headers" class="gov.cdc.sdp.cbr.EmailHeaders"/>
  <camelContext id="camel" trace="false" xmlns="http://camel.apache.org/schema/spring">
    <propertyPlaceholder id="properties" location="application.properties"/>
    <route id="email_sending_test_route">
      <from id="from_test" uri="direct:start"/>
      <doTry id="_doTry" >
        <to id="_to_the_ether" uri="aphl-s3://there_is_no_S3_here"/>
        <to id="_to_unreachable_endpoint" uri="mock:mock_endpoint"/>
        <doCatch id="_doCatch">
          <exception>java.lang.Exception</exception>          
		      <process id="setheaders" ref="set_email_headers"/>
		      <setBody>
		        <constant>An error has occurred!</constant>
		      </setBody>          
		      <to id="_to_email" uri="{{email.uri}}{{email.debugMode}}"/>
		      <to id="_to_mock" uri="mock:mock_endpoint"/>
        </doCatch>
      </doTry>
    </route>
  </camelContext>
</beans>
